- membership = current_user.memberships.where(:group_id => @page.group.id).first
- can_publish = membership.can_publish == 1 rescue false
- can_admin = membership.can_admin == 1 rescue false
- can_modify_others = membership.can_admin == 1 rescue false

#group-page  
  #group-header
    %h1= @group.name
  #group-page-inner
    #group-page-contents
      %h2= @page.title
      - if can_publish || current_user_is_admin
        #page-toolbar
          %a#edit-page-button= t :edit_this_page
      .content
        = raw(@page.content)
      .clearfix

    #group-page-files
      = render :partial => "page_files", :locals => {:page => @page, :membership => membership}

    - if can_publish || current_user_is_admin
      #edit-page
        = form_for(@page, :remote => true, :html => {:id => 'edit_page_form',:multipart => true}) do |f|
          = f.hidden_field :id
          .edit-page-title= f.text_field :title
          = f.text_area :content, :class => "tinymce", :id => "page-editor"
          = tinymce
          #save-page-button
            = submit_tag (t :save), :disable_with => (t :save_wait), :id => "page-save-submit"

- if params['__from__'] == 'url'
  = render :partial => 'groups/sidebar', :locals => {:group => @page.group }

- if params['__from__'] == 'url'
  :javascript
    afterGetPage(#{@page.id}, #{@page.group_id});
